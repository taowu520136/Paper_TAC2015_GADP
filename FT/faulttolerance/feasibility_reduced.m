clear all


% sigma=[x1 x2 x1^2 x1*x2 x1^3 ];  length=5
% bar_sigma=[x1^2 x2^2 x1^3 x1^4 x1^5 x1^6 x1x2 x1^2x2 x1^3x2] l=9
% phi = [x1 x2 x1^2] l=3
% bar_phi=[x1^2 x1x2 x2^2 x1^3 x1^2x2 x1^4 ] l=6


F=[0 -1 -3/2 0 -1/2;
   0 0   0   0 0];%
G=[0;1];
Q=diag([1,0,0,0, 0]);
R=1;
K=[6 -3 0 0 0];%

cvx_begin sdp
%cvx_precision best
variable P(3,3) symmetric
variable L(5,5) symmetric

Fc=F+G*K;
Fc1=[-2 0 -3/2 0 -1/2];

%p=[P(1,1) P(2,1)+P(1,2) P(2,2) P(1,3)+P(3,1) P(1,4)+P(4,1)+P(2,3)+P(3,2) P(1,5)+P(5,1)+P(2,4)+P(4,2) P(2,5)+P(5,2) P(3,3) P(3,4)+P(4,3) P(3,5)+P(5,3)+P(4,4) P(4,5)+P(5,4) P(5,5)]';
 
W=[2*P(1,1) P(1,2)+P(2,1) 3*P(1,3)+3*P(3,1) 2*P(2,3)+2*P(3,2) 4*P(3,3);
  P(1,2)+P(2,1) 2*P(2,2) P(2,3)+P(3,2) 0 0];  
P>=0;
%for i=1:2
H = ( 1/2*W(1,:)'*Fc1+1/2*Fc1'*W(1,:))+Q;%+K'*R*K;
H <= 0 ;
H(5,5)==L(5,5);
H(3,5)+H(5,3)==L(3,5)+L(5,3);
H(4,5)+H(5,4)==L(4,5)+L(5,4);
H(1,5)+H(5,1)+H(3,3)==L(1,5)+L(5,1)+L(3,3);
H(2,5)+H(5,2)+H(3,4)+H(4,3)==L(2,5)+L(5,2)+L(3,4)+L(4,3);
H(3,1)+H(1,3)==L(3,1)+L(1,3);
H(4,4)==L(4,4);
H(2,3)+H(3,2)+H(1,4)+H(4,1)==L(2,3)+L(3,2)+L(1,4)+L(4,1);
H(1,1)==L(1,1);
H(4,2)+H(2,4)==L(4,2)+L(2,4);
H(1,2)+H(2,1)==L(1,2)+L(2,1);
H(2,2)==L(2,2);
L<=0;
%end
minimize(P(1,1))
cvx_end

%eig(H)

%eig(P)
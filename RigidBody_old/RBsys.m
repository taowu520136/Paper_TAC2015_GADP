function dx = RBsys(t,x)
global K0 I1 I2 I3 flag
I1 = 3;
I2 = 1;
I3 = 0.5;
z =[ x(1), x(2), x(3), x(1)^2, x(1)*x(2), x(2)^2, x(1)*x(3), ...
     x(2)*x(3), x(3)^2, x(1)^3, x(1)^2*x(2), ...
     x(1)*x(2)^2, x(2)^3, x(1)^2*x(3), x(1)*x(2)*x(3), ...
     x(2)^2*x(3), x(1)*x(3)^2, x(2)*x(3)^2, x(3)^3]';
u = K0*z + (flag == 1)*0.05*sin(30*t);
x(1)=x(1);
x(2)=x(2);
x(3)=x(3);


dx =  [ (I2-I3)*x(2)*x(3) + u(1)
    (I3-I1)*x(1)*x(3) + u(2)
    (I1-I2)*x(1)*x(2) + u(3)]./[I1;I2;I3];

end